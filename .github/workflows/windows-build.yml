name: Build Windows Executable

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up MSYS2
      uses: msys2/setup-msys2@v2
      with:
        msystem: UCRT64
        install: >-
          mingw-w64-ucrt-x86_64-toolchain
          mingw-w64-ucrt-x86_64-python
          mingw-w64-ucrt-x86_64-python-pip
          mingw-w64-ucrt-x86_64-python-gobject
          mingw-w64-ucrt-x86_64-gtk4
          git

    - name: Install Python dependencies
      shell: msys2 {0}
      run: |
        pip install --upgrade pip
        pip install pyinstaller
        pip install -r requirements.txt

    - name: Build executable with PyInstaller
      shell: msys2 {0}
      run: |
        pyinstaller --noconfirm --onefile --windowed src/main.py --name your_app_name

    - name: Upload Artifact
      uses: actions/upload-artifact@v4
      with:
        name: your-app-windows
        path: dist/your_app_name.exe
